<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<title>登录 - Shopee Clone</title>
<style>
body { font-family: Arial; background: #f7f7f7; display:flex; justify-content:center; align-items:center; height:100vh; }
form { background:white; padding:30px; border-radius:10px; box-shadow:0 2px 10px rgba(0,0,0,0.1); }
input { display:block; width:250px; margin:10px 0; padding:8px; }
button { background:#f53d2d; color:white; border:none; padding:10px; width:100%; cursor:pointer; }
a { display:block; margin-top:10px; text-align:center; }
</style>
</head>
<body>

<form id="loginForm">
  <h2>登录账号</h2>
  <input type="text" id="username" placeholder="用户名" required>
  <input type="password" id="password" placeholder="密码" required>
  <button type="submit">登录</button>
  <a href="register.html">没有账号？去注册</a>
</form>

<script>
document.getElementById("loginForm").onsubmit = async function(e){
  e.preventDefault();
  const data = {
    action: "login",
    username: username.value,
    password: password.value
  };
  try {
    const res = await fetch("auth.php", {
      method:"POST",
      headers:{'Content-Type':'application/json'},
      body: JSON.stringify(data)
    });
    const msg = await res.json();
    if(msg.status === "ok"){
      // 登录成功，保存用户信息到 localStorage
      localStorage.setItem("user", JSON.stringify(msg.user));
      alert("登录成功！");
      window.location.href = "index.html";
    } else {
      alert("登录失败：" + msg.message);
    }
  } catch(err){
    alert("网络错误：" + err.message);
  }
};
</script>

</body>
</html>
